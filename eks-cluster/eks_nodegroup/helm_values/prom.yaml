// Create alert rules
serverFiles:
  alerting_rules.yml:
    groups:
      - name: Instances
        rules:
          - alert: InstanceDown
            expr: up == 0
            for: 10s
            labels:
              severity: critical
            annotations:
              description: '{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 5 minutes.'
              summary: 'Instance {{ $labels.instance }} down'
  config:
    route:
      group_by: ['alertname']
      group_wait: 30s
      group_interval: 5m
      receiver: critical-notifications
      repeat_interval: 3h
      routes:
        - match:
            severity: critical  # This matches the labels in your alerts
          receiver: 'critical-notifications'
    receivers:
      - name: 'critical-notifications'
        email_configs:
          - to: 'XXXX@gmail.com'
            from: 'devops4solutions@gmail.com'
            smarthost: 'smtp.gmail.com:587'
            auth_username: 'devops4solutions@gmail.com'
            auth_password: 'XXXX'
alertmanagers:
    - static_configs:
        - targets:
            - 'prometheus-alertmanager.monitoring.svc.cluster.local:9093' 
# this to create alert rules in prometheus

# This section of ingress is not working so I have created the ingress resource using directly yaml file instead of helm chart
#ingress:
  #enabled: true
  #ingressClassName: alb  # Specify ALB as the ingress controller
  
  ## Add necessary annotations for ALB
  #annotations:
   # alb.ingress.kubernetes.io/scheme: internet-facing  # Use "internal" if private
   # alb.ingress.kubernetes.io/target-type: ip  # Target type is IP
   # alb.ingress.kubernetes.io/group.name: prometheus-group  # Optional, groups ALB resources
   #alb.ingress.kubernetes.io/healthcheck-path: "/"  # Health check path
   # alb.ingress.kubernetes.io/success-codes: "200,302"  # Success codes for health check
  
  ## Define hostnames for the Ingress
  #hosts:
    #- host: prometheus.example.com  # Replace with your actual domain
     #paths:
     #   - path: /  # Path for the ingress
      #    pathType: Prefix  # Path type is Prefix